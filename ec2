tphardening@tphardening-virtual-machine:~/terraform$ cat ec2.tf
resource "aws_instance" "web" {
  ami           = "ami-0360c520857e3138f" # Amazon Linux 2
  instance_type = var.instance_type
  user_data     = <<-EOF
                #!/bin/bash
                yum update -y
                yum install -y httpd aws-cli
                systemctl start httpd
                systemctl enable httpd

                echo "Hello from EC2" > /var/www/html/index.html

                # Envoi de logs vers S3
                aws s3 cp /var/log/messages s3://${var.bucket_name}/ec2-logs/messages.txt
                EOF

  tags = {
    Name = "WebServer"
  }
}
